Reliable storage of cryptographic secret keys is challenging. This situation is particularly exacerbated in the cryptocurrency ecosystem, where anyone who controls the signing key for an account can typically take arbitrary action on the user's behalf. For example, an attacker with access to a user's key could transfer large sums of money out of a user's account with no recourse. Numerous cryptocurrency wallets have been developed to allow users to safeguard their keys while preserving their ease of use; we next describe some popular types.

\paragraph{Threshold wallets} Cryptocurrency wallets need to overcome significant technical hurdles in their quest to increase reliability while preserving the security of the keys.
For instance, attempts at increasing reliability using replication worsen security. This is because any replication makes it easier for the attacker to potentially access one of the replicated copies of the key. Threshold secret-sharing systems~\cite{CACM:Shamir79} offer an elegant middle ground: user keys are secret-shared among $n$ parties which we refer to as \emph{custodians}, and access to $t$ of them is required to access the key. Thus, user keys can be recovered even if $n-t$ of the custodians become non-responsive. At the same time, an attacker needs to to access $t$ key shares to recover the key. 

Custodian threshold wallets offer robust security and reliability guarantees. However, these custodians need to remain online to provide users with easy access to their keys. For example, at least $t$ out of $n$ custodians need to remain online at all times in case a user decides to perform a transaction involving a secret key that the custodians hold on the user's behalf. Furthermore, this requirement that the custodians are always online poses additional risks. In particular, a software vulnerability in the custodian servers could jeopardize the secrecy of the held secret shares, and such a vulnerability could be easy to exploit since these servers are necessarily online and listening for requests. 

\paragraph{Cold wallets} Cold (i.e., offline) wallets avoid the aforementioned limitation of the custodian hot (i.e., always online) wallets because they do not always stay online. However, this affects their usability. A typical compromise is to keep only limited funds in the online wallet, with most of a user's assets kept in a highly secure air-gapped wallet. This can be realized via, e.g., a deterministic wallet~\cite{deterministic-wallets,CCS:DasFauLos19,CCS:ADEFKRS20,EPRINT:Hu23,ESORICS:ErwRia22}, which enables unlinkable transfers to an offline wallet by specifying how to deterministically derive session keys from a master public-private keypair. Thus, the online wallet can compute and publish the current session public key, allowing anyone to transfer money to the cold wallet (which can derive the corresponding session private key). 
This idea is standardized by the BIP32 proposal~\cite{bip32}. %, which also defines how these session keys can be derived in a hierarchical manner to create ``child'' wallets who can control their own funds. 
 % Because the master secret key (and any session/child secret keys) must still be stored in a trusted place, this makes the offline wallet a highly valuable target when it inevitably comes online to transfer funds to the online wallet.
 % Although a recent work~\cite{EPRINT:DEFLR23} shows how to enable threshold child wallets, the issue of a single point of failure still persists at the root wallet. 

\paragraph{Backing up high-value keys} While hot and cold wallets provide reasonable security and usability tradeoffs, all of the systems built upon them today seem inadequate for backing up rarely-used high-value secret keys. 
In particular, users or institutions may want to securely and reliably store high-value asset keys they don't frequently need access to. Furthermore, users may want to back up keys from other systems for recovery in case of catastrophic losses in the parent system. This is an important use case that arises in several situations. In particular:
\begin{enumerate}
\item Consider a cryptocurrency exchange which is frequently used by individuals to store cryptocurrency long-term, in a similar way to a bank~\cite{coinbase-philosophy,coinbase-deposits,kraken-security}. 
 The net inflows and outflows of cryptocurrency from the exchange might be roughly equal over short- and mid-term periods, meaning that the exchange rarely needs to access the bulk of its cryptocurrency deposits.  However, because the value of these deposits could be extremely large, the key (or keys) safeguarding these rarely-accessed deposits need to be securely backed up in a way that reflects their value.

 \item An individual with a high cryptocurrency net worth would be in a very similar situation:  they might secure the bulk of their cryptocurrency with a key that is very rarely used and perhaps send enough funds once a year to a ``hot'' wallet or similar system for their yearly expenses.

\item Finally, interestingly, this issue also arises in the threshold wallet setting. Many systems may remove threshold signing parties when they fail to meet some predefined criteria, e.g., exceed maximal response latency or produce invalid signature shares. However, to maintain high security, threshold wallets should maintain a minimum number of nodes. If the signing set becomes too small, parties can no longer be removed, but may still exhibit behavior that would warrant removal under normal circumstances. In such cases, a backup recovery process is needed to regenerate the signing key shares.

For example, Lit Protocol, a cryptographic key management provider offering a threshold signing network, specifies a backup recovery mechanism to restore the system to an operational state in such cases~\cite{lit-whitepaper}. However, the backup system currently functions only as a snapshot and is not ideal as a backup system. In particular, the current backup system does not support refreshes of the key shares, reducing the security of the overall system, and has no way of checking backup integrity. %Adopting our protocols will instead enable this feature as well as periodic checks that the backed up shares remain valid. Other threshold systems have desired the forenamed properties in a protocol, but until now, no such system existed.
\end{enumerate}

\section{Novel Design Requirements}\label{sec:reqs}
In our envisioned high-security backup system, cryptographic secret keys are used infrequently. This contrasts with the goals of easy accessibility in traditional wallet systems. Thus, our new setting necessitates a hardened system along with a novel set of design requirements aimed at defending against well-resourced nation-state adversaries. In particular: 
\begin{enumerate}
\item \textbf{Hardened Security and Strong Recovery Properties.} Similar to threshold wallets, we want backed-up keys to be secret-shared and have the shares spread over a highly distributed network. First, we want geographic distribution to avoid key-share losses from natural disasters. Second, we need key shares placed in disparate jurisdictions to safeguard against government actors. Finally, we need key shares placed with machines deployed from different hardware manufacturers using varying operating systems. Given these more stringent requirements, storing key shares across more custodians than is typical (e.g., $67$-out-of-$100$) is warranted. This allows for hardened security and reliability in case recovery is needed.

\item \textbf{Security of Each Secret Share is Backed by a Cold Wallet Portion.} Online machines get hacked rather frequently. Furthermore, in the case of nation-state adversaries, the exploited vulnerability can be quite sophisticated and could remain undetected for years. Thus, we require that each custodian holds each user-key's secret share jointly in a hot (i.e., online) and a cold (i.e., offline) portion of the wallet. The cold wallet should always stay offline, potentially on an air-gapped computer in a secure location. Of course, the cold wallet will need to be accessed if recovery is initiated, but this is the only time it should be used. Thus, recovery will need access to $t$ cold wallet portions, one each for each utilized secret share. Consequently, the recovery process will be slow. However, for us this is not a deal-breaker since in our system, recovery requests are infrequent. In fact, this additional lockup period provides time to perform due diligence in checking the veracity of the recovery request. 

Nonetheless, we insist that the backup process be fast and avoid the need for access to the cold portion of the wallet. Implicitly, this requires that no key-share-specific information is stored on the cold portion of the wallet, and its memory requirements are minimal --- in particular, independent of the number of users whose keys it stores. 

\item \textbf{Post-Compromise Security.} Given that online machines get hacked frequently, it is possible that over time, an attacker may gather cryptographic secrets held by several custodians. Thus, we require that the system supports hot wallet portions regularly updating their key material in coordination with the other hot wallet custodians such that infected machines can recover from such leakage. 

\item \textbf{Continual Assurance of a Key's Safekeeping.} We also need a mechanism to continually assure users that their keys are safely stored. This feature is critical because our system is not designed to allow users to easily make transactions, which typically also serve as a way for users to check the safe storage of their keys. Absent such continual assurances, users could be duped into a false sense of security that their keys have been safely backed up. Thus, we require security against (potentially) malicious custodians who actively delete user keys while still attempting to falsely convince users about the safekeeping of their keys. 

\item \textbf{Hiding System Users.} Finally, given a user transaction on chain, it should not be possible to determine whether it was created using our system. This is essential, since such information could help attackers identify and target users with high-value keys. 
\end{enumerate}

Lastly, we remark that any secret key storage solution is only as good as the strength of the keys it stores. Thus, we insist that the keys stored in our system are themselves generated via a distributed key generation (DKG) protocol, and the key shares are delivered to the custodians directly.%\footnote{Given these secure key shares as input, custodians can compute the backup key shares non-interactively on their own.
% \noemi{They can actually compute the key shares non-interactively; but they need a dealer or some MPC to compute helping values for the proofs of remembrance (namely, KZG commitment to the polynomial interpolation of their shares, and the corresponding opening proofs).}

Going forward, we will refer to a backup system meeting the above design requirements as an \emph{\hcwl}.